============================= test session starts ==============================
platform darwin -- Python 3.12.7, pytest-8.4.1, pluggy-1.6.0 -- /Users/arhaankhaku/Documents/Development/Projects/Slynx/venv/bin/python3.12
cachedir: .pytest_cache
metadata: {'Python': '3.12.7', 'Platform': 'macOS-15.5-arm64-arm-64bit', 'Packages': {'pytest': '8.4.1', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.9.0', 'metadata': '3.1.1'}}
rootdir: /Users/arhaankhaku/Documents/Development/Projects/Slynx
plugins: anyio-4.9.0, metadata-3.1.1
collecting ... collected 6 items

slynx_test.py::test_prediction_hindi PASSED                              [ 16%]
slynx_test.py::test_prediction_marathi PASSED                            [ 33%]
slynx_test.py::test_prediction_telugu PASSED                             [ 50%]
slynx_test.py::test_prediction_bengali PASSED                            [ 66%]
slynx_test.py::test_prediction_malayyam PASSED                           [ 83%]
slynx_test.py::test_transliterate_hindi FAILED                           [100%]

=================================== FAILURES ===================================
___________________________ test_transliterate_hindi ___________________________

    def test_transliterate_hindi():
        hindi_transliterator = HindiTransliterator()
        hindi_transliterator.run_pipeline(train_new_model=False, epochs=10, batch_size=64)
        text = "kyu bhai? muhje paani nahi chahiye. maine ek baar bola."
>       assert hindi_transliterator.transliterate(text) == "क्यों भाई? मुझे पानी नहीं चाहिए। मैंने एक बार बोला।", "Test Failed! Transliteration incorrect"
E       AssertionError: Test Failed! Transliteration incorrect
E       assert 'क्यू भाई? मु... एक बार बोला.' == 'क्यों भाई? म... एक बार बोला।'
E         
E         - क्यों भाई? मुझे पानी नहीं चाहिए। मैंने एक बार बोला।
E         ?    ^^        ^                 ^   ^              ^
E         + क्यू भाई? मुहजे पानी नहीं चाहिए. मैनने एक बार बोला.
E         ?    ^        ^^                 ^   ^              ^

slynx_test.py:51: AssertionError
----------------------------- Captured stdout call -----------------------------
Max sequence length: 37
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 257ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 263ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 12ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 18ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 16ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 17ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 16ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 16ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 15ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 11ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 16ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 16ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 11ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 30ms/step
----------------------------- Captured stderr call -----------------------------
Filter:   0%|          | 0/186500 [00:00<?, ? examples/s]Filter:  31%|███       | 58000/186500 [00:00<00:00, 565490.83 examples/s]Filter:  68%|██████▊   | 126000/186500 [00:00<00:00, 626531.82 examples/s]Filter: 100%|██████████| 186500/186500 [00:00<00:00, 624569.00 examples/s]
Map:   0%|          | 0/186500 [00:00<?, ? examples/s]Map:   2%|▏         | 4370/186500 [00:00<00:04, 43622.45 examples/s]Map:   5%|▍         | 8859/186500 [00:00<00:04, 44361.21 examples/s]Map:   8%|▊         | 15454/186500 [00:00<00:03, 44133.45 examples/s]Map:  11%|█         | 19910/186500 [00:00<00:03, 44277.38 examples/s]Map:  14%|█▍        | 26431/186500 [00:00<00:03, 43931.63 examples/s]Map:  18%|█▊        | 32953/186500 [00:00<00:03, 43757.51 examples/s]Map:  20%|██        | 37354/186500 [00:00<00:03, 43820.71 examples/s]Map:  23%|██▎       | 43803/186500 [00:01<00:03, 43518.27 examples/s]Map:  27%|██▋       | 50312/186500 [00:01<00:03, 43473.38 examples/s]Map:  30%|███       | 56783/186500 [00:01<00:02, 43361.08 examples/s]Map:  34%|███▍      | 63222/186500 [00:01<00:02, 43216.00 examples/s]Map:  37%|███▋      | 69551/186500 [00:01<00:02, 42892.78 examples/s]Map:  41%|████      | 75903/186500 [00:01<00:02, 42724.93 examples/s]Map:  44%|████▍     | 82207/186500 [00:01<00:02, 42475.60 examples/s]Map:  46%|████▋     | 86497/186500 [00:02<00:02, 42568.28 examples/s]Map:  50%|████▉     | 92853/186500 [00:02<00:02, 42502.81 examples/s]Map:  52%|█████▏    | 97115/186500 [00:02<00:02, 42526.85 examples/s]Map:  55%|█████▌    | 103480/186500 [00:02<00:01, 42493.45 examples/s]Map:  59%|█████▉    | 109840/186500 [00:02<00:01, 42462.11 examples/s]Map:  62%|██████▏   | 116195/186500 [00:02<00:01, 42428.54 examples/s]Map:  65%|██████▍   | 120539/186500 [00:02<00:01, 42661.42 examples/s]Map:  67%|██████▋   | 124879/186500 [00:02<00:01, 42843.27 examples/s]Map:  70%|███████   | 131289/186500 [00:03<00:01, 42793.82 examples/s]Map:  73%|███████▎  | 135583/186500 [00:03<00:01, 42828.26 examples/s]Map:  76%|███████▌  | 141969/186500 [00:03<00:01, 42733.91 examples/s]Map:  80%|███████▉  | 148279/186500 [00:03<00:00, 42510.14 examples/s]Map:  82%|████████▏ | 152569/186500 [00:03<00:00, 42602.91 examples/s]Map:  84%|████████▍ | 156863/186500 [00:03<00:00, 42687.17 examples/s]Map:  86%|████████▋ | 161186/186500 [00:03<00:00, 42830.46 examples/s]Map:  90%|████████▉ | 167516/186500 [00:03<00:00, 42597.09 examples/s]Map:  93%|█████████▎| 173932/186500 [00:04<00:00, 42652.36 examples/s]Map:  96%|█████████▌| 178269/186500 [00:04<00:00, 42825.99 examples/s]Map:  99%|█████████▉| 184658/186500 [00:04<00:00, 42742.79 examples/s]Map: 100%|██████████| 186500/186500 [00:04<00:00, 42912.88 examples/s]
Map:   0%|          | 0/186500 [00:00<?, ? examples/s]Map:   3%|▎         | 6100/186500 [00:00<00:02, 60881.47 examples/s]Map:   7%|▋         | 12197/186500 [00:00<00:02, 60926.96 examples/s]Map:  11%|█▏        | 21319/186500 [00:00<00:02, 60855.68 examples/s]Map:  16%|█▋        | 30322/186500 [00:00<00:02, 60479.91 examples/s]Map:  21%|██        | 39382/186500 [00:00<00:02, 60444.07 examples/s]Map:  26%|██▌       | 48400/186500 [00:00<00:02, 60326.40 examples/s]Map:  29%|██▉       | 54438/186500 [00:00<00:02, 60339.09 examples/s]Map:  32%|███▏      | 60482/186500 [00:01<00:02, 60364.59 examples/s]Map:  36%|███▌      | 66564/186500 [00:01<00:01, 60488.62 examples/s]Map:  39%|███▉      | 72617/186500 [00:01<00:01, 60498.04 examples/s]Map:  44%|████▍     | 81636/186500 [00:01<00:01, 60354.47 examples/s]Map:  49%|████▊     | 90668/186500 [00:01<00:01, 60302.42 examples/s]Map:  53%|█████▎    | 99339/186500 [00:01<00:01, 59466.82 examples/s]Map:  58%|█████▊    | 107888/186500 [00:01<00:01, 58665.39 examples/s]Map:  62%|██████▏   | 116168/186500 [00:01<00:01, 57570.89 examples/s]Map:  67%|██████▋   | 124603/186500 [00:02<00:01, 57150.81 examples/s]Map:  71%|███████▏  | 133128/186500 [00:02<00:00, 57051.22 examples/s]Map:  76%|███████▌  | 141742/186500 [00:02<00:00, 57141.26 examples/s]Map:  79%|███████▉  | 147518/186500 [00:02<00:00, 57277.95 examples/s]Map:  84%|████████▎ | 155810/186500 [00:02<00:00, 56623.35 examples/s]Map:  87%|████████▋ | 161564/186500 [00:02<00:00, 56838.56 examples/s]Map:  90%|████████▉ | 167640/186500 [00:02<00:00, 57827.37 examples/s]Map:  93%|█████████▎| 173639/186500 [00:02<00:00, 58398.31 examples/s]Map:  96%|█████████▋| 179684/186500 [00:03<00:00, 58959.66 examples/s]Map: 100%|█████████▉| 185708/186500 [00:03<00:00, 59318.64 examples/s]Map: 100%|██████████| 186500/186500 [00:03<00:00, 58924.47 examples/s]
Map:   0%|          | 0/186500 [00:00<?, ? examples/s]Map:   4%|▍         | 7400/186500 [00:00<00:02, 73874.31 examples/s]Map:   8%|▊         | 14789/186500 [00:00<00:02, 73876.54 examples/s]Map:  14%|█▍        | 25714/186500 [00:00<00:02, 73289.09 examples/s]Map:  20%|█▉        | 36688/186500 [00:00<00:02, 73155.77 examples/s]Map:  26%|██▌       | 47605/186500 [00:00<00:01, 73005.78 examples/s]Map:  29%|██▉       | 54933/186500 [00:00<00:01, 73077.37 examples/s]Map:  33%|███▎      | 62286/186500 [00:00<00:01, 73201.62 examples/s]Map:  37%|███▋      | 69662/186500 [00:00<00:01, 73358.22 examples/s]Map:  43%|████▎     | 80736/186500 [00:01<00:01, 73522.74 examples/s]Map:  47%|████▋     | 88095/186500 [00:01<00:01, 73539.65 examples/s]Map:  51%|█████     | 95473/186500 [00:01<00:01, 73602.34 examples/s]Map:  55%|█████▌    | 102862/186500 [00:01<00:01, 73681.77 examples/s]Map:  61%|██████    | 113901/186500 [00:01<00:00, 73643.83 examples/s]Map:  67%|██████▋   | 124977/186500 [00:01<00:00, 73710.37 examples/s]Map:  73%|███████▎  | 135853/186500 [00:01<00:00, 73307.11 examples/s]Map:  77%|███████▋  | 143297/186500 [00:01<00:00, 73576.60 examples/s]Map:  81%|████████  | 150811/186500 [00:02<00:00, 73974.70 examples/s]Map:  87%|████████▋ | 161367/186500 [00:02<00:00, 72694.22 examples/s]Map:  92%|█████████▏| 171918/186500 [00:02<00:00, 71901.49 examples/s]Map:  98%|█████████▊| 182474/186500 [00:02<00:00, 71401.57 examples/s]Map: 100%|██████████| 186500/186500 [00:02<00:00, 72917.76 examples/s]
/Users/arhaankhaku/Documents/Development/Projects/Slynx/venv/lib/python3.12/site-packages/keras/src/saving/saving_lib.py:802: UserWarning: Skipping variable loading for optimizer 'rmsprop', because it has 16 variables whereas the saved optimizer has 30 variables. 
  saveable.load_own_variables(weights_store.get(inner_path))
=========================== short test summary info ============================
FAILED slynx_test.py::test_transliterate_hindi - AssertionError: Test Failed!...
========================= 1 failed, 5 passed in 33.76s =========================
